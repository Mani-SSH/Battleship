{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.reconstructPacket = exports.deconstructPacket = void 0;\n\nconst is_binary_js_1 = require(\"./is-binary.js\");\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\n\n\nfunction deconstructPacket(packet) {\n  const buffers = [];\n  const packetData = packet.data;\n  const pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n\n  return {\n    packet: pack,\n    buffers: buffers\n  };\n}\n\nexports.deconstructPacket = deconstructPacket;\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (is_binary_js_1.isBinary(data)) {\n    const placeholder = {\n      _placeholder: true,\n      num: buffers.length\n    };\n    buffers.push(data);\n    return placeholder;\n  } else if (Array.isArray(data)) {\n    const newData = new Array(data.length);\n\n    for (let i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n\n    return newData;\n  } else if (typeof data === \"object\" && !(data instanceof Date)) {\n    const newData = {};\n\n    for (const key in data) {\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\n        newData[key] = _deconstructPacket(data[key], buffers);\n      }\n    }\n\n    return newData;\n  }\n\n  return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\n\n\nfunction reconstructPacket(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n\n  return packet;\n}\n\nexports.reconstructPacket = reconstructPacket;\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder === true) {\n    const isIndexValid = typeof data.num === \"number\" && data.num >= 0 && data.num < buffers.length;\n\n    if (isIndexValid) {\n      return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n    } else {\n      throw new Error(\"illegal attachments\");\n    }\n  } else if (Array.isArray(data)) {\n    for (let i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === \"object\") {\n    for (const key in data) {\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\n        data[key] = _reconstructPacket(data[key], buffers);\n      }\n    }\n  }\n\n  return data;\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","reconstructPacket","deconstructPacket","is_binary_js_1","require","packet","buffers","packetData","data","pack","_deconstructPacket","attachments","length","isBinary","placeholder","_placeholder","num","push","Array","isArray","newData","i","Date","key","prototype","hasOwnProperty","call","_reconstructPacket","undefined","isIndexValid","Error"],"sources":["D:/codes/Battleship/battleship/front-end/node_modules/socket.io-parser/build/cjs/binary.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reconstructPacket = exports.deconstructPacket = void 0;\nconst is_binary_js_1 = require(\"./is-binary.js\");\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nfunction deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nexports.deconstructPacket = deconstructPacket;\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (is_binary_js_1.isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nfunction reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    packet.attachments = undefined; // no longer useful\n    return packet;\n}\nexports.reconstructPacket = reconstructPacket;\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}